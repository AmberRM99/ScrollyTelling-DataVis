<!DOCTYPE html>

<html lang="en" class="mac chrome102 js"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<head>
  <title>ScrollyTelling Health</title>
  <meta name="description" content="A data visualisation storytelling experience exploring changes surrounding global health between 2009 and today. Submitted for Information Is Beautiful World DataViz challenge 'What Just Happened?'">
  <meta name="keywords" content="Data, Data Visualisation, Healthcare, global, government, health">
  <meta name="author" content="ArcTaurus">
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.7.0/d3.min.js"></script>
<script src='https://cdn.plot.ly/plotly-2.16.1.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js'></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script> 
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<link rel="stylesheet" href="font.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
html, body, section {
  block-size: 100%;
    background: #15294A;
    font-family:'Roboto Condensed';
    /* font-size:28pt; */
}

h1{
  text-align:center;
  font-size: 1.5em;
    margin-block-start: 0.83em;
    margin-block-end: 0.83em;
    display: block;
    margin-block-start: 0.67em;
    margin-block-end: 0.67em;
    margin-inline-start: 0;
    margin-inline-end: 0;
    font-weight: bold;
}


h3{
  display: block;
    font-size: 1.17em;
    margin-block-start: 1em;
    margin-block-end: 1em;
    margin-inline-start: 0;
    margin-inline-end: 0;
    font-weight: bold;
}

h4{
  display: block;
  font-size: 1.1em;
    margin-block-start: 1.33em;
    margin-block-end: 1.33em;
    margin-inline-start: 0;
    margin-inline-end: 0;
    font-weight: bold;
}

h6{
  display: block;
    font-size: 0.67em;
    margin-block-start: 2.33em;
    margin-block-end: 2.33em;
    margin-inline-start: 0;
    margin-inline-end: 0;
    font-weight: bold;
}
html {
  scroll-snap-type: y mandatory;
}

.AboutChart{
  display:flex;
  flex-direction: column;
}

.AboutChart p{
  font-size:1.4rem;
  padding: 0 1.5rem;
}

.TotalLives{
  background-color:#15294A;
  padding:0;
  display:flex;
  flex-direction: column;
}

.TotalLives .row{
  display: flex;
    flex-direction: row-reverse;
}
.peopleChartTxt {
  font-size: 1.5rem;
  display: flex;
  height: 8rem;
  align-items: center;
  height: auto;
}

.col-8{
  justify-content: flex-start;
  display:flex;
  align-items: center;
  flex-wrap:wrap;
}

section {
  scroll-snap-align: start;
  scroll-snap-stop: always;
  scroll-snap-type: y mandatory;
  
  padding: 0 4%;
  display: flex;
  align-items: center;
  justify-content: center;
  
  color: #BAE9E4;
  background: #15294A;
}

body {
  margin: 0;
  font-family: system-ui, sans-serif;
  font-size: 4rem;
}

.glassButton{
  background: #BAE9E4;
  border: 2px solid #2ca08ecf;
  box-shadow: 0px 4px 4px #031025;
  border-radius: 15px;
  color: #0B7564;
  width:26%;
  text-align:    center;
  font-size: 1.8rem;
  padding:10px;
  text-decoration: none;
  transition:all 0.5s ease-out;
}

.glassButton:hover{
  background: #0B7564;
    box-shadow: 0px 4px 4px #9fe0d840;
  text-decoration: none;
  color:#BAE9E4;
}

.glassButton:hover span{
  transform: scale(1.1) perspective(1px);
    will-change: transform;
}

.citation{
  text-align:center;
  font-size: 0.9rem;
}

#scroll-progress {
  position: fixed;
  bottom: 0;
  width: 2%;
  height: 4px;
  background: #D52D1F;
  z-index: 10000;
}

.maskB {
  -webkit-mask-image: url(baby.svg);
  mask-image: url(baby.svg);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;    
}

 .maskM {
  -webkit-mask-image: url(mother.svg);
  mask-image: url(mother.svg);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;    
}

.babyPercent{
  background-image: linear-gradient(0deg, #48998C 70%, #48998c4a 72%);
   
}
.babyPercent, .motherPercent{
  width: 20rem;
  height: 20rem;
}

.motherPercent{
  width: 15rem;
  background:linear-gradient(0deg,#D52D1F 95%,#D52D1F4a 97%)
}

/* .loadDash {
    position: relative;
    display: inline-block;
    padding: 1rem;
    cursor: pointer;
    color: #FFF;
    letter-spacing: 1px;
    background: #377e72 none repeat scroll 0% 0%;
    border: none;
    border-radius: 4px;
    box-shadow: 0 1px 0 rgb(255 255 255 / 25%), 0 1px 0 rgb(255 255 255 / 25%) inset, 0 0 0 rgb(0 0 0 / 50%) inset, 0 1.25rem 0 rgb(255 255 255 / 8%) inset, 0 -1.25rem 1.25rem rgb(0 0 0 / 30%) inset, 0 1.25rem 1.25rem rgb(255 255 255 / 10%) inset;
    transition: all 0.2s linear 0s;
    margin: 0.618rem;
    width: 26%;
    text-align: center;
    font-size: 1.4rem;
    text-decoration: none;
}

.loadDash i{
  font-size:2rem;
  padding-right:5px;
}

.loadDash:hover,
.loadDash:focus {
  color:white;
  text-decoration: none;
  box-shadow:
    0 2px 5px rgba(0, 0, 0, 0.5),
    0 1px 0 rgba(255, 255, 255, 0.25) inset,
    0 0 0 rgba(0, 0, 0, 0.25) inset,
    0 20px 0 rgba(255, 255, 255, 0.03) inset,
    0 -20px 20px rgba(0, 0, 0, 0.15) inset,
    0 20px 20px rgba(255, 255, 255, 0.05) inset;
}
.loadDash:active {
  box-shadow:
    0 1px 0 rgba(255, 255, 255, 0.25),
    0 1px 0 rgba(255, 255, 255, 0) inset,
    0 0 5px rgba(0, 0, 0, 0.5) inset,
    0 20px 0 rgba(255, 255, 255, 0.03) inset,
    0 -20px 20px rgba(0, 0, 0, 0.15) inset,
    0 20px 20px rgba(255, 255, 255, 0.05) inset;
}

.loadDash::before {
  content: "";
  display: block;
  position: absolute;
  background:-moz-linear-gradient(left, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 50%, rgba(255,255,255,0) 100%);
  background:-webkit-gradient(linear, left top, right top, color-stop(0%,rgba(255,255,255,0)), color-stop(50%,rgba(255,255,255,1)), color-stop(100%,rgba(255,255,255,0)));
  background:-webkit-linear-gradient(left, rgba(255,255,255,0) 0%,rgba(255,255,255,1) 50%,rgba(255,255,255,0) 100%);
  background:linear-gradient(left, rgba(255,255,255,0) 0%,rgba(255,255,255,1) 50%,rgba(255,255,255,0) 100%);
  padding: x 12px;
  top: 0;
  left: 15%;
  height: 1px;
  width: 40%;
  box-shadow: 0 1px 5px rgba(255, 255, 255, 0.2);
  transition: all 0.3s ease-in-out 0s;
}
.loadDash:active::before {
  opacity: 0;
}
.loadDash:hover::before {
  left: 45%;
} */

.MotherInfantLoss{
    display: flex;
    flex-direction: column;
    /* padding: 0 27px; */
    width: 30%;
    margin-right: 1.5rem;
}

.personCount{
  transition: opacity 4000ms;
  will-change: opacity;
  color:#15294A;
  font-size: 2.8rem;
    margin: 1.25rem;
  animation-name: people;
  animation-duration: 0.5s;
  animation-iteration-count: 1;
  animation-fill-mode: forwards;
}

@keyframes people {
  0% {color:#15294A}
  50%{color:#48998C}
  100% {color: #BAE9E4}
}

.peopleImg{
  opacity: 0;
}

@keyframes IMGpeople {
  0% {opacity:0}
  100% {opacity: 1}
}

.livesSaved::after {
  content: '1,232,'counter(count);
  animation: counter 3s linear 1 alternate;
  counter-reset: count 402;
}

.babyStat, .motherStat{
  font-size:1.5rem;
}

.babyStat::after {
  content: counter(Bcount)'%';
  animation: counterBMort 3s ease-out 1 alternate;
  counter-reset: Bcount 27;
}
.motherStat::after {
  content: counter(Mcount) ;
  animation: counterMMort 3s ease-out 1 alternate;
  counter-reset: Mcount 295000;
}

@keyframes counter {
  0% {
    counter-set: count 330;
  }
  10% {
    counter-set: count 338;
  }
  20% {
    counter-set: count 346;
  }
  30% {
    counter-set: count 352;
  }
  40% {
    counter-set: count 359;
  }
  50% {
    counter-set: count 367;
  }
  60% {
    counter-set: count 374;
  }
  70% {
    counter-set: count 385;
  }
  80% {
    counter-set: count 391;
  }
  90% {
    counter-set: count 398;
  }
  100% {
    counter-set: count 406;
  }
}

@keyframes counterMMort {
  0% {
    counter-set: Mcount 354000;
  }
  10% {
    counter-set: Mcount 343000;
  }
  20% {
    counter-set: Mcount 334000;
  }
  30% {
    counter-set: Mcount 326000;
  }
  40% {
    counter-set: Mcount 319000;
  }
  50% {
    counter-set: Mcount 313000;
  }
  60% {
    counter-set: Mcount 306000;
  }
  70% {
    counter-set: Mcount 300000;
  }
  100% {
    counter-set: Mcount 295000;
  }
}

@keyframes counterBMort {
  0% {
    counter-set: Bcount 39;
  }
  10% {
    counter-set: Bcount 37;
  }
  20% {
    counter-set: Bcount 36;
  }
  30% {
    counter-set: Bcount 35;
  }
  40% {
    counter-set: Bcount 33;
  }
  50% {
    counter-set: Bcount 32;
  }
  60% {
    counter-set: Bcount 31;
  }
  70% {
    counter-set: Bcount 30;
  }
  80% {
    counter-set: Bcount 29;
  }
  90% {
    counter-set: Bcount 29;
  }
  100% {
    counter-set: Bcount 27;
  }
}

@media screen and (max-width:1090px){
  h1{
    font-size: 1em;
  }
  h3{
    font-size: 0.89em;
  }
  h4{
    font-size: 0.6em;
  }
  h6{
    font-size: 0.48em;
  }
}

@media screen and (max-width:760px){
  .AboutChart{
  display:none;
  }
}

</style>
</head>
<body>
<div id="scroll-progress"></div>
<section style="display:flex; flex-direction:column;">
  <h1>Global Healthcare has come a long way in 10 years</h1>
  <img style="position:absolute; top:0;left:70%;" width="400" height="100" src="WGS-summit-logo.png" alt="World Government Summit Logo">

</section>
<section>
  <h3>Global healthcare spending has increased
  <!-- <div id="chart"></div></h1> -->
  </h3><div id="GHE"></div>
</section>
<section style=" padding-top: 5rem;display:flex; flex-direction: column;">
  <div id="GHEGPD"></div>
  <p class="citation">*figures for 2021 OR most recently published data (last 5 years)</p>
</section>
<section style="overflow:hidden;">
  <img style="position:absolute;top: 142rem; left:60%;opacity:0.8;" width="40%" height="40%" src="/thermom.svg">
  <img style="position:absolute;top: 170rem; left:60%;opacity:0.7;" width="40%" height="40%" src="/bottle.svg">
  <img style="position:absolute;top: 142rem; left:0;opacity:0.7;" width="40%" height="40%" src="/plaster.svg">
  <img style="position:absolute;top: 170rem;left:0;opacity:0.8;" width="40%" height="40%" src="/needle.svg">
  <h6 style="text-align:center;width:80%;">The effects of this spending can be seen in some of the most notable diseases of our time</h6>
</section>
<section>
  <div class="AboutChart "  >
  <h3>The total number of AIDS cases dropped</h3>
  <p >There is still no cure for HIV and AIDS, but decreasing cases numbers offers hope that greater awareness and access to screening will continue to save lives</p>
</div>
  <div id="AIDS"></div>
</section>
<section>
  <div id="polio"></div>
  <div class="AboutChart "   ><h3>Polio cases went down </h3><p >But we know cases can drop further, in 2016 there were a mere 42 cases globally, meaning we were close to eradication</p></div>
</section>
<section>
  <div class="AboutChart "  >
  <h3>Fewer people are living with Tuberculosis</h3>
  <p > One of the United Nations Sustainable Development Goals (SDGs) is to eradicate Tuberculosis by 2030</p>
</div>
  <div id="TB"></div>
</section>
<section>
  <div id="malaria"></div>
  <div class="AboutChart "  >
    <h3>Less at risk people are catching Malaria</h3>
  <p > Malaria is classed as a treatable disease thanks to drug advancements, but its deadly reputation spawns from unequal access to lifesaving medications in impoverished areas.</p>
  </div>
 
</section>
<section>
  <div class="AboutChart" >
  <h3>More than half the world has eradicated Malaria</h3>
  <p style="font-size:1rem;">Eradication is defined as 3+ years without a single case</p>
  </div>
  <div id='myDiv'></div>
</section>
<section style="display:flex; flex-direction:column;">
  <h3 style="text-align:center;">More pregnancies end in a healthy baby and mother today compared to 2009</h3>
  <!-- <img class="maskB" alt="Baby Pram" src="/baby.svg"> -->
  <div class="container" style="display:flex; flex-direction:row; justify-content:space-around;">
<div class="row" style="display: flex;">
  <div class="col maskB babyPercent" > </div>
  <div class="col"><span id="BMortality"></span> <p style="font-size:1rem;">Infant Mortality Rate</p></div>
</div>
<div class="row" style="display: flex;">
  <div class="maskM motherPercent"></div>
  <div class="col"><span id="MMortality"></span> <p style="font-size:1rem;">Maternal deaths</p></div>
</div>
  </div>
  <!-- <p class="citation">*https://data.worldbank.org/indicator/SH.STA.MMRT</p> -->
</section>
<section>
  <div class="MotherInfantLoss">
  <h4>But there's still more work to be done</h4>
<p style="font-size:1.3rem;">Every hour, hundreds of families are devastated by the loss of an expectant mother or baby during childbirth</p>
</div>
<div id="MotherBaby"></div>
</section>
<section  style='display:flex; flex-direction:column;'>
 <span style="font-size:8rem;" class="fa-sharp fa-solid fa-person"></span>
  <h6 style="text-align:center;width:80%;">An estimated <span style="font-size:0.8rem; position:relative; bottom:1.5rem;">*</span> <span id="livesFigure"></span>  lives were saved through medical advancements in infectious diseases</h6>
  <p  class='citation'> *Estimate based on 10 year difference in Tuberculosis, Malaria and HIV/AIDS deaths</p>

</div>
</section>
<section id="testing" style="display:flex; flex-direction:column;">
  <h6 style="margin:1rem;"> Each figure represents 10,000 lives saved</h6>
  <p style="font-size:1.3rem;">That's more people than the entire population of Cyprus</p>
  <div style="display: flex;
  flex-wrap: wrap;"  id="peopleHolder">
  
</div>
</section>
<!--3284078-->
<section class="TotalLives" id="totalLives">

  <div class="container">
    <div class="row" >
      <div class="col-8" id="MalariaPeople">
       
      </div>
      <div class="col peopleChartTxt"> 257,596 less lives lost to Malaria
      </div>
    </div>
    <div class="row" style="margin-top:3rem;">
      <div class="col-8" id="HIVPeople">
       
      </div>
      <div class="col peopleChartTxt">
        480,000 less lives lost to HIV/AIDS
      </div>
    </div>
    <div class="row" style="margin:3rem 0;">
      <div class="col-8" id="TBPeople">
        
      </div>
      <div class="col peopleChartTxt">
        494,810 less lives lost to TB
      </div>
    </div>

    <p class="citation">One person per 10000 estimated lives saved</p>
  </div>
  
</section>

<section style='display:flex; flex-direction:column;'>
  <h1>How many more lives can be saved in the next 10 years?</h1>
  <!-- <a class="loadDash" href="DataVisStoryDashboard.html"> <i class="fas fa-clipboard-medical"></i> Monitor the World's Health </a> -->
  <a class="glassButton" href="DataVisStoryDashboard.html"><i class="fas fa-clipboard-medical"></i><span>  Monitor the World's Health </span></a>
</section>
  
  <script>
const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;

$.fn.isInViewport = function() {
    var elementTop = $(this).offset().top;
    var elementBottom = elementTop + $(this).outerHeight();

    var viewportTop = $(window).scrollTop();
    var viewportBottom = viewportTop + $(window).height();

    return elementBottom > viewportTop && elementTop < viewportBottom;
};
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array
}
$(window).on('resize scroll', function() {
  const scrollProgress = document.getElementById('scroll-progress');
  const scrollTop = document.body.scrollTop || document.documentElement.scrollTop;
  scrollProgress.style.width = `${(scrollTop / height) * 100}%`;

    if($('#MotherBaby').isInViewport()){
      // startAnimation()
    }
    if ($('#MMortality').isInViewport()) {
        $('#MMortality').addClass('motherStat')
    } else{
      $('#MMortality').removeClass('motherStat')
    }
    if ($('#BMortality').isInViewport()) {
        $('#BMortality').addClass('babyStat')
    } else{
      $('#BMortality').removeClass('babyStat')
    }
    if ($('#livesFigure').isInViewport()) {
        $('#livesFigure').addClass('livesSaved')
    } else{
      $('#livesFigure').removeClass('livesSaved')
    }
    if($('#totalLives').isInViewport()){
      let img = document.getElementsByClassName('peopleImg');
      for(let i=0; i<img.length; i++){
        img[i].style.animationName = 'IMGpeople'
        img[i].style.animationDuration = '0.5s'
        img[i].style.animationIterationCount = 1;
        img[i].style.animationFillMode = 'forwards'
        img[i].style.animationDelay = i/4+'s'
      }

      if($('.peopleImg').length === 0){
      let Malariatotal = 26;
      var MdocFrag = document.createDocumentFragment();
      let HIVtotal = 49;
      var HdocFrag = document.createDocumentFragment();
      let TBtotal = 50;
      var TdocFrag = document.createDocumentFragment();

      for(var i = 0; i < Malariatotal; i++) {
        let figure = document.createElement('i');
        figure.style.animationName = 'IMGpeople'
        figure.style.animationDuration = '0.5s'
        figure.style.animationIterationCount = 1;
        figure.style.animationFillMode = 'forwards'
        figure.style.animationDelay = i/5+'s'
            figure.classList.add('fas', 'fa-person', 'peopleImg')
            if(i === Malariatotal-1){
              figure.style.background =  "-webkit-linear-gradient(left, #BAE9E4 0%, #fff0 50%)";
              figure.style.webkitBackgroundClip = "text";
              figure.style.webkitTextFillColor ="transparent";
            }
            MdocFrag.appendChild(figure); 
      }
      for(var y = 0; y < HIVtotal; y++) {
        let figure = document.createElement('i');
        figure.style.animationName = 'IMGpeople'
        figure.style.animationDuration = '0.5s'
        figure.style.animationIterationCount = 1;
        figure.style.animationFillMode = 'forwards'
        figure.style.animationDelay = y/5+'s'
            figure.classList.add('fas', 'fa-person', 'peopleImg')
            if(y === HIVtotal-1){
              figure.style.background =  "-webkit-linear-gradient(left, #BAE9E4 0%, #fff0 50%)";
              figure.style.webkitBackgroundClip = "text";
              figure.style.webkitTextFillColor ="transparent";
            }
            HdocFrag.appendChild(figure); 
      }
      for(var z = 0; z < TBtotal; z++) {
        let figure = document.createElement('i');
        figure.style.animationName = 'IMGpeople'
        figure.style.animationDuration = '0.5s'
        figure.style.animationIterationCount = 1;
        figure.style.animationFillMode = 'forwards'
        figure.style.animationDelay = z/5+'s'
            figure.classList.add('fas', 'fa-person', 'peopleImg')
            if(z === TBtotal-1){
              figure.style.background =  "-webkit-linear-gradient(left, #BAE9E4 0%, #fff0 50%)";
              figure.style.webkitBackgroundClip = "text";
              figure.style.webkitTextFillColor ="transparent";
            }
            TdocFrag.appendChild(figure); 
      }
      document.getElementById('MalariaPeople').appendChild(MdocFrag); 
      document.getElementById('HIVPeople').appendChild(HdocFrag); 
      document.getElementById('TBPeople').appendChild(TdocFrag); 
    }
  } else{
        $('.peopleImg').remove();
      }
  if($('#peopleHolder').isInViewport()){
      if($('.personCount').length === 0){
      let total = 1232406;
      var docFrag = document.createDocumentFragment();
      var foo = [];

      for (var i = 1; i <= 124; i++) {
        foo.push(i);
      }
      shuffleArray(foo)
      for(var i = 0; i < total/10000; i++) {
        let figure = document.createElement('i');
            figure.classList.add('fas', 'fa-person', 'personCount')
            figure.style.animationDelay= foo[i]/10+'s';
            if(i === 123){
              figure.style.background =  "-webkit-linear-gradient(left, #BAE9E4 0%, #fff0 20%)";
              figure.style.webkitBackgroundClip = "text";
              figure.style.webkitTextFillColor ="transparent";
            }
            docFrag.appendChild(figure); 

      }
      document.getElementById('peopleHolder').appendChild(docFrag); 
    }
  } else{
        $('.personCount').remove();
      }
});

// console.log(shuffleArray(foo))


</script>

<script>    

  d3.csv('malaria.csv', function(err, rows){

  function filter_and_unpack(rows, key, year) {
  return rows.filter(row => row['certified'] <= year).map(row => row[key])
  }

  var frames = []
  var slider_steps = []

  var n = 12;
  var num = 2009;
  for (var i = 0; i <= n; i++) {
    var z = filter_and_unpack(rows, 'certified', num)
    var locations = filter_and_unpack(rows, 'Alpha-3 code', num)
    frames[i] = {data: [{z: z, locations: locations, text: locations}], name: num}
    slider_steps.push ({
        label: num.toString(),
        method: "animate",
        args: [[num], {
            mode: "immediate",
            transition: {duration: 300},
            frame: {duration: 300}
          }
        ]
      })
    num = num + 1
  }


var data = [{
  marker_line_width: 10,
      type: 'choropleth',
      locationmode: 'ISO-3',
      locations: frames[0].data[0].locations,
      z: frames[0].data[0].z,
      text: frames[0].data[0].locations,
      colorscale:[[0,"#488699"], [0.4,"#48998C"], 
    [1, "#F1FCFA"]], 
      zauto: false,
      // zmin: 1963,30
      zmax: 2021

}];


var layout = {
  geo: {
    showframe: false,
      showland: true,
      landcolor:"rgba(0,0,0,0)",  
      bgcolor:"rgba(0,0,0,0)",
      lakecolor:"rgba(0,0,0,0)",
      oceancolor:"rgba(0,0,0,0)",
      countrycolor: "black" ,
        coastlinecolor:"#2A4065",
      // projection: {
      //     type: 'robinson'
      // }
  },
   margin: {
    l: 50,
    r: 50,
    b: 200,
    t: 200,
    pad: 1
  },
  dragmode: false,
  font: {
  family: 'Roboto Condensed, monospace',
  size: 18,
  color: '#BAE9E4'
  },

  paper_bgcolor:"rgba(0,0,0,0)",
   height:700,
    updatemenus: [{
      x: 0.1,
      y: 0,
      yanchor: "top",
      xanchor: "right",
      showactive: false,
      direction: "left",
      type: "buttons",
      pad: {"t": 87, "r": 10},
      buttons: [{
        method: "animate",
        args: [null, {
          mode: "immediate",
          fromcurrent: true,
          transition: {
            duration: 200,
          },
          frame: {
            duration: 500
          }
        }],
        label: "Play"
      }, {
        method: "animate",
        args: [   
          [null],
          {
            mode: "immediate",
            transition: {
              duration: 0
            },
            frame: {
              duration: 0
            }
          }
        ],
        label: "Pause"
      }]
    }],
    sliders: [{
      active: 0,
      steps: slider_steps,
      x: 0.1,
      len: 0.9,
      xanchor: "left",
      y: 0,
      yanchor: "top",
      pad: {t: 50, b: 10},
      currentvalue: {
        visible: true,
        prefix: "Year:",
        xanchor: "right",
        font: {
          size: 20,
          color: "#9FE0D8"
        }
      },
      transition: {
        duration: 300,
        easing: "cubic-in-out"
      }
    }]
};

var config = {responsive: true,displayModeBar: false}

Plotly.newPlot('myDiv', data, layout, config).then(function() {
    Plotly.addFrames('myDiv', frames);
  });
})

</script>

<script>

Plotly.newPlot('AIDS', [{
  x: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019],
  y: [2399929, 2370918, 2342046, 2314238, 2285709, 2265234, 2243665, 2196714, 2131659, 2042488, ],
  line: {
    color: '#D52D1F',
    width: 3
  },
}], {
  xaxis: {range: [2008, 2020]},
  yaxis: {range: [2042488, 2399929]},
    plot_bgcolor:"rgba(0,0,0,0)",
    paper_bgcolor:"rgba(0,0,0,0)",
    yaxis: {
      tickcolor: "rgba(0,0,0,0)",
      tickwidth: 15,
      
      gridcolor: "rgba(0,0,0,0)",
      gridwidth: 15,
      
      zerolinecolor: "rgba(0,0,0,0)",
      zerolinewidth: 2,
      // title: {
      // text: 'Total Num of Cases (millions)',
      // }
    },
    xaxis: {
      tickcolor: "rgba(0,0,0,0)",
      tickwidth: 50,
      
      gridcolor: "rgba(0,0,0,0)",
      gridwidth: 2,      
    },
     font: {
  family: 'Roboto Condensed, monospace',
  size: 18,
  color: '#fff'
  },

}).then(function () {
  Plotly.addFrames('AIDS', [
    {
      data: [{x: [0, 0], y: [0, 0]}],
      name: 'frame1'
    }, {
      data: [{x: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019],
  y: [2399929, 2370918, 2342046, 2314238, 2285709, 2265234, 2243665, 2196714, 2131659, 2042488 ]}],
      name: 'frame2'
    }
  ]);
})

function startAnimationAids() {
  Plotly.animate('AIDS', ['frame1', 'frame2'], {
    frame: [
      {duration: 1500},
      {duration: 500},
    ],
    transition: [
      {duration: 800, easing: 'elastic-in'},
      {duration: 100, easing: 'cubic-in'},
    ],
    mode: 'afterall'
  })
}
</script>
<script>
   var trace3 = {
    x: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020],
    y: [70.6,	69.5,	66.5,	64.3,	61.8,	59.8,	58.9,	58.7,	59.2,	57.2,	56.3,	59.5],
  //   fill: 'tozeroy',
  // type: 'scatter',
    //   marker: {
    //     color: '#D52D1F',
    //     size: 8
    //   },
      line: {
          color: '#D52D1F',
          width: 3
        },
        // name: 'Infected'
    };


  //   var healthy = {
  //   x: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020],
  //   y: [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000],
  //   fill: 'tozeroy',
  // type: 'scatter',
  //     marker: {
  //       color: '#9FE0D8',
  //       size: 8
  //     },
  //     line: {
  //         color: '#9FE0D8',
  //         width: 3
  //       },
  //       name: 'Healthy'
  //   };
    
    var data = [trace3];
    
    var layout = {
      title: 'Malaria infections per 1000 at risk people',
      automargin:true,
      xaxis: {range: [2008, 2022]},
        yaxis: {range: [0, 1787]},
      
          plot_bgcolor:"rgba(0,0,0,0)",
          paper_bgcolor:"rgba(0,0,0,0)",
          yaxis: {
            tickcolor: "rgba(0,0,0,0)",
            tickwidth: 15,
            
            gridcolor: "rgba(0,0,0,0)",
            gridwidth: 15,
            
            zerolinecolor: "rgba(0,0,0,0)",
            zerolinewidth: 2,
      //       title: {
      // text: 'Total Num of Cases (millions)',
      // }
          },
          xaxis: {
            tickcolor: "rgba(0,0,0,0)",
            tickwidth: 50,
            
            gridcolor: "rgba(0,0,0,0)",
            gridwidth: 2,      
          },
          font: {
        family: 'Roboto Condensed, monospace',
        color: '#BAE9E4'
        },
    };
    var config = {responsive: true,displayModeBar: false}
    
    Plotly.newPlot('malaria', data, layout, config);
</script>
<script>
  Plotly.newPlot('polio', [{
  x: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021],
  y: [1787,	1412,	716	,293,	481,	415,	106,	42,	118,	138,	554	,1253,	649 ],
  
  line: {
    color: '#D52D1F',
    width: 3
  },
}], {
  xaxis: {range: [2008, 2022]},
  yaxis: {range: [0, 1787]},

    plot_bgcolor:"rgba(0,0,0,0)",
    paper_bgcolor:"rgba(0,0,0,0)",
    yaxis: {
      tickcolor: "rgba(0,0,0,0)",
      tickwidth: 15,
      
      gridcolor: "rgba(0,0,0,0)",
      gridwidth: 15,
      
      zerolinecolor: "rgba(0,0,0,0)",
      zerolinewidth: 2,
      // title: {
      // text: 'Malaria cases per 1000 at risk',
      // }
    },
    xaxis: {
      tickcolor: "rgba(0,0,0,0)",
      tickwidth: 50,
      
      gridcolor: "rgba(0,0,0,0)",
      gridwidth: 2,      
    },
    annotations: [
    {
      x: 2016,
      y: 42,
      xref: 'x',
      yref: 'y',
      text: 'Only 42 cases in 2016',
      showarrow: true,
      arrowhead: 7,
      ax: 0,
      ay: -40,
      font:{
        color: '#9FE0D8',
      },
      align: 'center',
      arrowhead: 2,
      arrowsize: 1,
      arrowwidth: 2,
      arrowcolor: '#9FE0D8',
      ax: 20,
      ay: -90,
    }
  ],
     font: {
  family: 'Roboto Condensed, monospace',
  size: 18,
  color: '#fff'
  },
//MAKE A LOOP FOR FRAMES, MAKE IT LONGER EACH TIME
}).then(function () {
  Plotly.addFrames('polio', [
    {
      
      data: [{x: [2009, 2010], y: [1787, 1412]}],
      name: 'frame1'
    }, {
      data: [{  x: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021],
  y: [1787,	1412,	716	,293,	481,	415,	106,	42,	118,	138,	554	,1253,	649 ]}],
      name: 'frame2'
    }
  ]);
})

function startAnimationPolio() {
  Plotly.animate('polio', ['frame1', 'frame2'], {
    frame: [
      {duration: 1500},
      {duration: 500},
    ],
    transition: [
      {duration: 800, easing: 'elastic-in'},
      {duration: 100, easing: 'cubic-in'},
    ],
    mode: 'afterall'
  })
}
</script>

<script>
  Plotly.newPlot('GHE', [{
  x: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019],
  y: [874,	912,	986,	996,	1012,	1035,	994,	1016,	1057,	1103,	1122],
  
  line: {
    color: '#9FE0D8',
    width: 3
  },
}], {
  xaxis: {range: [2008, 2022]},
  yaxis: {range: [0, 1787]},

    plot_bgcolor:"rgba(0,0,0,0)",
    paper_bgcolor:"rgba(0,0,0,0)",
    yaxis: {
      tickcolor: "rgba(0,0,0,0)",
      tickwidth: 15,
      
      gridcolor: "rgba(0,0,0,0)",
      gridwidth: 15,
      
      zerolinecolor: "rgba(0,0,0,0)",
      zerolinewidth: 2,
      title: {
      text: 'Spending Per Capita ($)',
      font: {
        size: 16,
        color:'#BAE9E4'
      },
      pad: {t: 50, b: 10},
      }
    },
    xaxis: {
      tickcolor: "rgba(0,0,0,0)",
      tickwidth: 50,
      
      gridcolor: "rgba(0,0,0,0)",
      gridwidth: 2,      
    },
     font: {
  family: 'Roboto Condensed, monospace',
  size: 18,
  color: '#fff'
  },
//MAKE A LOOP FOR FRAMES, MAKE IT LONGER EACH TIME
}).then(function () {
  Plotly.addFrames('GHE', [
    {
      
      data: [{x: [2009, 2010], y: [1787, 1412]}],
      name: 'frame1'
    }, {
      data: [{  x: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019],
  y: [874,	912,	986,	996,	1012,	1035,	994,	1016,	1057,	1103,	1122]}],
      name: 'frame2'
    }
  ]);
})

function startAnimationGHE() {
  Plotly.animate('GHE', ['frame1', 'frame2'], {
    frame: [
      {duration: 1500},
      {duration: 500},
    ],
    transition: [
      {duration: 800, easing: 'elastic-in'},
      {duration: 100, easing: 'cubic-in'},
    ],
    mode: 'afterall'
  })
}
</script>

<script>
  
  Plotly.newPlot('TB', [{
  x: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
  y: [1417403,	1386717,	1353969	,1321313,	1289369,	1261016,	1236143,	1213057],
  
  line: {
    color: '#D52D1F',
    width: 3
  },
}], {
  xaxis: {range: [2008, 2022]},
  yaxis: {range: [0, 1787]},

    plot_bgcolor:"rgba(0,0,0,0)",
    paper_bgcolor:"rgba(0,0,0,0)",
    yaxis: {
      tickcolor: "rgba(0,0,0,0)",
      tickwidth: 15,
      
      gridcolor: "rgba(0,0,0,0)",
      gridwidth: 15,
      
      zerolinecolor: "rgba(0,0,0,0)",
      zerolinewidth: 2,
    },
    xaxis: {
      tickcolor: "rgba(0,0,0,0)",
      tickwidth: 50,
      
      gridcolor: "rgba(0,0,0,0)",
      gridwidth: 2,      
    },
     font: {
  family: 'Roboto Condensed, monospace',
  size: 18,
  color: '#fff'
  },

}).then(function () {
  Plotly.addFrames('TB', [
    {
      data: [{x: [0, 0], y: [0, 0]}],
      name: 'frame1'
    }, {
      data: [{  x: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021],
  y: [1787,	1412,	716	,293,	481,	415,	106,	42,	118,	138,	554	,1253,	649 ]}],
      name: 'frame2'
    }
  ]);
})

function startAnimationTB() {
  Plotly.animate('TB', ['frame1', 'frame2'], {
    frame: [
      {duration: 1500},
      {duration: 500},
    ],
    transition: [
      {duration: 800, easing: 'elastic-in'},
      {duration: 100, easing: 'cubic-in'},
    ],
    mode: 'afterall'
  })
}
</script>

<script>    
  d3.csv('babymotherhour.csv', function(err, rows){
  function filter_and_unpack(rows, key, index) {
    // console.log(rows)
  return rows.slice(0, index).map(row => row[key])
  }
  
  function unpack(rows, key) {
      return rows.map(function(row) { return row[key]; });
  }

  var frames = []
  var slider_steps = []
  
  var n = 12;
  var num = 2;
  // console.log(rows)
  // console.log(rows)
  for (var i = 2; i <= (rows.length); i++) {
    var y = filter_and_unpack(rows, 'y', num)
    // console.log(y)
    var x = filter_and_unpack(rows, 'x', num)
    var locations = filter_and_unpack(rows, 'Alpha-3 code', num)
    var colors=filter_and_unpack(rows, 'person', num)
    frames[num] = {data: [
      {
        // type: 'scattergeo',
        // mode:"markers",
        lat: y,
        lon:x,
        //  locations: locations,
          // text: locations,
          marker:{
        // colorscale:"redor",
        size:5,
        color:colors,
        colorbar: {
            autotic: false,
            tickprefix: '$',
            len: 0.8,
            x: 1,
            y: 0.6
        },
        showscale: false,
        opacity:0.8
      },
        }
      ], name: num}
    slider_steps.push ({
        label: Math.round(num/rows.length*60).toString(),
        method: "animate",
        args: [[num], {
            mode: "immediate",
            transition: {duration: 0},
            frame: {duration: 1}
          }
        ]
      })
    num = num + 1
  }

var data = [
  {
      type: 'scattergeo',
      mode:"markers",
      lat:[filter_and_unpack(rows,"y",1)],
      lon:[filter_and_unpack(rows,"x",1)],
      marker:{
        size:5,
        color:[filter_and_unpack(rows,"person",1)],
        opacity:0.8
      },
      showscale: false,

},

];
var layout = {
  geo: {
    showframe: false,
      showland: true,
      landcolor:"#040F21",  
      bgcolor:"rgba(0,0,0,0)",
      lakecolor:"rgba(0,0,0,0)",
      oceancolor:"rgba(0,0,0,0)",
      // countrycolor: "black" ,
        coastlinecolor:"#485976",
  },
  margin: {
    l: 50,
    r: 50,
    b: 200,
    t: 200,
    pad: 1
  },
  dragmode: false,
  height:800,
  annotations: [
    {
      xref: 'paper',
    yref: 'paper',
    x: 0.7,
    xanchor: 'right',
    y: 1,
    xanchor: 'right',
    yanchor: 'bottom',
      text: 'Maternal deaths',
      showarrow: false,
      font: {
        size: 16,
        color: '#ffffff'
      },
      align: 'center',
      bordercolor: '#D52D1F',
      borderwidth: 2,
      borderpad: 4,
      bgcolor: '#D52D1F',
      opacity: 0.8
    },
    {
      xref: 'paper',
    yref: 'paper',
    x: 0.3,
    xanchor: 'right',
    y: 1,
    yanchor: 'bottom',
      text: 'Infant deaths',
      showarrow: false,
      font: {
        size: 16,
        color: '#0d2c33'
      },
      align: 'center',
      bordercolor: '#42DBFD',
      borderwidth: 2,
      borderpad: 4,
      bgcolor: '#42DBFD',
      opacity: 0.8
    }
  ],
  font: {
        family: 'Roboto Condensed, monospace',
        color: '#BAE9E4'
        },
  paper_bgcolor:"rgba(0,0,0,0)",
  showscale: false,
  // width:1000,
  updatemenus: [{
        x: 0.1,
        y: 0,
        yanchor: "top",
        xanchor: "right",
        showactive: false,
        direction: "left",
        type: "buttons",
        pad: {"t": 87, "r": 10},
        buttons: [{
          method: "animate",
          args: [null, {
            fromcurrent: true,
            transition: {
              duration: 1,
            },
            frame: {
              duration: 0
            }
          }],
          label: "Play"
        }, {
          method: "animate",
          args: [   
            [null],
            {
              mode: "immediate",
              transition: {
                duration: 0
              },
              frame: {
                duration: 0
              }
            }
          ],
          label: "Pause"
        }]
      }],
      sliders: [{
        active: 0,
        steps: slider_steps,
        x: 0.1,
        len: 0.9,
        xanchor: "left",
        y: 0,
        yanchor: "top",
        pad: {t: 50, b: 10},
        currentvalue: {
          visible: true,
          suffix: " minutes from now",
          xanchor: "right",
          font: {
            size: 20,
            color: "#9FE0D8"
          }
        },
        transition: {
          duration: 300,
          easing: "cubic-in-out"
        }
      }]
};
var config = {responsive: true,displayModeBar: false}


Plotly.newPlot('MotherBaby', data, layout, config).then(function() {
    Plotly.addFrames('MotherBaby', frames);
  });
})

function startAnimation() {
  console.log('start anim called')
  Plotly.animate('MotherBaby', frames, {
    frame: [
      {duration: 1500},
      {duration: 500},
    ],
    transition: [
      {duration: 800, easing: 'elastic-in'},
      {duration: 100, easing: 'cubic-in'},
    ],
    mode: 'afterall'
  })
}

//   d3.csv('/dashboard.csv', function(err, rows){
// function filter_and_unpack(rows, key, year) {
// return rows.filter(row => row <= year).map(row => row[key])
// }
// function unpack(rows, key) {
//     return rows.map(function(row) { return row[key]; });
// }
// var data = [
// {
//         type:"choropleth",
//         locationmode: 'country names',
//         locations:unpack(rows,"indicator"),
//         z:unpack(rows,"% of population with access to electricity"),
//         colorscale:["#EADEDA","#A44A3F"],
//         showscale:false
//       },

// ];

// // Plotly.newPlot('myDiv', data, layout).then(function() {
//   Plotly.addTraces('myDiv', data);
// // });
// })
</script>
<script>
  d3.csv('healthcareExpense.csv', function(err, rows){
      function unpack(rows, key) {

          return rows.map(function(row) { return row[key]; });
      }

       var data = [{
            type: 'choropleth',
            locations: unpack(rows, 'CODE'),
            z: unpack(rows, 'GDP (BILLIONS)'),
            text: unpack(rows, 'COUNTRY'),
            colorscale: [
            [0,'#BAE9E4'],[1,'#0C3035']],
            autocolorscale: false,
            reversescale: true,
            marker: {
                line: {
                    color: 'rgb(180,180,180)',
                    width: 0.5
                }
            },
            tick0: 0,
            zmin: 0,
            dtick: 1000,
            colorbar: {
                autotic: false,
                ticksuffix: '%',
            }
      }];

      var layout = {
        title: 'Health Expenditure per GPD (%)',
        margin: {
    l: 0,
    r: 0,
    b: 0,
    t: 50,
    pad: 10
  },
  dragmode: false,
  height:650,
        dragmode: false,
  font: {
  family: 'Roboto Condensed, monospace',
  size: 18,
  color: '#BAE9E4'
  },
        title: 'Healthcare Expenditure (% of GPD)',
          geo:{
              showframe: false,
              showcoastlines: false,
              projection:{
                  type: 'mercator'
              },
              showland: true,
              landcolor:"#2A4065",  
              bgcolor:"rgba(0,0,0,0)",
              lakecolor:"rgba(0,0,0,0)",
              oceancolor:"rgba(0,0,0,0)",
              countrycolor: "black" ,
              coastlinecolor:"#2A4065",
          },
          paper_bgcolor:"rgba(0,0,0,0)",
      };
      var config = {responsive: true,displayModeBar: false}
      Plotly.newPlot("GHEGPD", data, layout,config,{showLink: false});
});
</script>
</body>
</html>
